Winnti's abuse of GitHub repository leaves the site in the tricky position of deciding which projects can stay and which ones to shut down
- Thu thập mẫu
- List GitHub độc
- Forensics, recon info
- Phân tích mẫu
- Viết report

**Lưu ý:** Vì lý do account github đã bị report và gỡ bỏ nên không thể tìm được list github độc cũng như thu nhập mẫu (kể cả đã forensic theo 2 dữ kiện của bài là:
   - 1)The GitHub account was created in May 2016, and its sole repository, mobile-phone-project, was created in June 2016.


   - 2) ![1](/uploads/ba68e2914b05cce0275c1e5308ba00c4/1.png)

Kết quả tìm ra được project Time Machine Theme như hình trên nhưng list Github của member target lại không tìm thấy:
![2](/uploads/9d7dcd1f159996e70a6ab6c25d51ea62/2.png)

Nguồn tài liệu kham khảo: 
  - http://www.infoworld.com/article/3184399/security/malware-finds-unwitting-ally-in-github.html


  - http://blog.trendmicro.com/trendlabs-security-intelligence/winnti-abuses-github/

## I, thông tin chung

Mã độc này được `Winnti` (1 nhóm được biết đến với những chiến dịch gián điệp mạng nhắm vào các công ty phần mềm, đặc biệt là những công ty trong ngành công nghiệp trò chơi điện tử) sử dụng để kết nối tới account Github để có vị trí chính xác của các máy chủ C&C server. 

Nó đã tìm kiếm một trang HTML được lưu trữ trong dự án GitHub (ở đây là `mobile-phone-project`) để lấy được chuỗi mã hoá có chứa địa chỉ IP và số cổng cho máy chủ C&C. Sau đó, nó sẽ kết nối với địa chỉ IP và cổng đó để nhận được chỉ thị tiếp theo.

Tài khoản GitHub chứa 14 file HTML khác nhau, không cùng thời gian tạo. Các file HTML này tham chiếu đến gần 20 địa chỉ IP.

## II, Malware Analysis


Malware thuộc loại `PlugX`, có 2 file được chia ra rõ dàng: file loader (`loadperf.dll`) và file payload (`loadoerf.ini`).

* `loadperf.dll` là file chuẩn của Microsoft và có chữ ký số, và trong lúc file `loadperf.dll` làm việc, nó sẽ import các file DLL có lien quan và bao gồm cả file payload ( `loadoerf.ini` ).

![3](/uploads/8bcad19b76bcd5883770263476e4a07e/3.png)
                                                 **Hình 1:Section .idata added to the original loadperf.dll**

* `loadoerf.ini`: - khi nó được load bởi hệ thống, `DLLMain` sẽ giải mã payload thông qua `“CryptUnprotectData”`

![4](/uploads/918533919ff25583d52bf8ca898a4f8b/4.png)
**hình 2: Part of the decryption function used in the payload**

Sau khi giải mã xong, 1 phần code được chạy trên máy, sau đó được tiêm vào svchost.exe ( dấu hiệu PlugX ), Payload sau đó được load vào bộ nhớ.

![5](/uploads/369f46cb5d3d60149823036fb93b9cc3/5.png)
**hình 3: Execution/infection flow of loadoerf.ini**

## III, C&C Servers

Gần như tất cả các máy chủ C & C đều được lưu trữ tại Hoa Kỳ, trong khi hai máy tính ở Nhật.

| C&C Server’s IP Address | Port Number |
| -------- | -------- |
| 160.16.243.129   | 443 (HTTPS)   |
| 160.16.243.129   | 53 (DNS)  | 
| 160.16.243.129   | 80 (HTTP)   | 
| 174.139.203.18   | 443 (HTTPS)   | 
| 174.139.203.18   | 53 (DNS)  | 
| 174.139.203.20   | 53 (DNS)   | 
| 174.139.203.22   | 443 (HTTPS)   | 
| 174.139.203.22   | 53 (DNS)   | 
| 174.139.203.27   | 53 (DNS)   | 
| 174.139.203.34   | 53 (DNS)   | 
| 174.139.62.58   | 80 (HTTP)   | 
| 174.139.62.60   | 443 (HTTPS)   | 
| 174.139.62.60   | 53 (DNS)   | 
| 174.139.62.60   | 80 (HTTP)   | 
| 174.139.62.61   | 443 (HTTPS)   | 
| 61.195.98.245   | 443 (HTTPS)   | 
| 61.195.98.245   | 53 (DNS)   | 
| 61.195.98.245   | 80 (HTTP)   | 
| 67.198.161.250   | 443 (HTTPS)   | 
| 67.198.161.250   | 53 (DNS)   | 
| 67.198.161.251   | 443 (HTTPS)   | 
| 67.198.161.252   | 443 (HTTPS)   | 

>Related Hashes (SHA256) detected as BKDR64_WINNTI.ONM:
1. 06b077e31a6f339c4f3b1f61ba9a6a6ba827afe52ed5bed6a6bf56bf18a279ba — cryptbase.dll
2. 1e63a7186886deea6c4e5c2a329eab76a60be3a65bca1ba9ed6e71f9a46b7e9d – loadperf.dll
3. 7c37ebb96c54d5d8ea232951ccf56cb1d029facdd6b730f80ca2ad566f6c5d9b – loadoerf.ini
4. 9d04ef8708cf030b9688bf3e8287c1790023a76374e43bd332178e212420f9fb — wbemcomn.ini
5. b1a0d0508ee932bbf91625330d2136f33344ed70cb25f7e64be0620d32c4b9e2 — cryptbase.ini
6. e5273b72c853f12b77a11e9c08ae6432fabbb32238ac487af2fb959a6cc26089 — wbemcomn.dll






